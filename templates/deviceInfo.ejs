<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Include Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Include Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <title>Chart.js with Bootstrap</title>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-md navbar-dark bg-dark">
      <div class="container">
        <a href="#" class="navbar-brand"><strong>AIgRICULTURE</strong></a>

        <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#nav" aria-controls="nav" aria-label="Expand Navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-center" id="nav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a href="#" class="nav-link active" aria-current="page">Home</a>
            </li>
            <li class="nav-item">
              <a href="/login" class="nav-link">Login</a>
            </li>
            <li class="nav-item">
              <a href="/register" class="nav-link">Register</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </header>
    <div class="container-fluid">
        <div class="row bg-primary align-baseline ">
            <div class="col-12 mb-3">
                <div class = "container-fluid">
                    <div class="btn-group" role="group" aria-label="Chart switcher">
                        <button id="temperatureButton" type="button" class="btn btn-primary p-1  ">Temprature</button>
                        <button id="moistureButton" type="button" class="btn btn-primary p-1">Moisture</button>
                        <button id="humidityButton" type="button" class="btn btn-primary p-1">Hummidity</button>
                        <button id="lightButton" type="button" class="btn btn-primary p-1">Light</button>
                        <button id="co2Button" type="button" class="btn btn-primary p-1">Co2</button>
                        <button type="button" class="btn btn-primary p-1">Setting</button>
                        <button type="button" class="btn btn-primary p-1">ASAA</button>
                    </div>
                </div>
                
            </div>
        </div>
        <div class="row">
            <div class="col-sm-4 col-lg-7">
                <!-- Canvas for the chart -->
                <div style="position: relative; height:80vh; width:100%">
                    <canvas id="myChart"></canvas>
                </div>
            </div>
            <div class="col-lg-2 ">
                <!-- Div cards -->
                <div class="card p-1 mb-3">
                    <div class="card-body">
                        <h5 class="card-title">Temprature</h5>
                        <div class="card-img">
                            <div class="feature-icon d-inline-flex align-items-center justify-content-start  text-bg-primary bg-gradient fs-2 mb-3">
                                <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-thermometer-half" viewBox="0 0 16 16">
                                  <path d="M9.5 12.5a1.5 1.5 0 1 1-2-1.415V6.5a.5.5 0 0 1 1 0v4.585a1.5 1.5 0 0 1 1 1.415"/>
                                  <path d="M5.5 2.5a2.5 2.5 0 0 1 5 0v7.55a3.5 3.5 0 1 1-5 0zM8 1a1.5 1.5 0 0 0-1.5 1.5v7.987l-.167.15a2.5 2.5 0 1 0 3.333 0l-.166-.15V2.5A1.5 1.5 0 0 0 8 1"/>
                                </svg>
                                <div class="card-text align-content-around justify-content-center m-1 ">55 c</div>
                              </div>
                              
                            </div>
                    </div>
                </div>
                <div class="card p-1 mb-3">
                    <div class="card-body">
                        <h5 class="card-title">Hummidity</h5>
                        <div class="card-img ">
                            <div class="feature-icon d-inline-flex align-items-center justify-content-start  text-bg-primary bg-gradient fs-2 mb-3">
                                <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-droplet" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M7.21.8C7.69.295 8 0 8 0q.164.544.371 1.038c.812 1.946 2.073 3.35 3.197 4.6C12.878 7.096 14 8.345 14 10a6 6 0 0 1-12 0C2 6.668 5.58 2.517 7.21.8m.413 1.021A31 31 0 0 0 5.794 3.99c-.726.95-1.436 2.008-1.96 3.07C3.304 8.133 3 9.138 3 10a5 5 0 0 0 10 0c0-1.201-.796-2.157-2.181-3.7l-.03-.032C9.75 5.11 8.5 3.72 7.623 1.82z"/>
                                    <path fill-rule="evenodd" d="M4.553 7.776c.82-1.641 1.717-2.753 2.093-3.13l.708.708c-.29.29-1.128 1.311-1.907 2.87z"/>
                                  </svg>
                                <div class="card-text align-content-around justify-content-center  m-1 ">55 c</div>
                              </div>
                        </div>
                    </div>
                </div>
               
                <!-- Repeat the above div for the remaining 3 cards -->
            </div>
            <div class="col-lg-2 ">
                <div class="card p-1 mb-3">
                    <div class="card-body">
                        <h5 class="card-title">Light</h5>
                        <div class="card-img ">
                            <div class="feature-icon d-inline-flex align-items-center justify-content-start  text-bg-primary bg-gradient fs-2 mb-3">
                                <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-sun" viewBox="0 0 16 16">
                                    <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6m0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0m9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708"/>
                                  </svg>
                                <div class="card-text align-content-around justify-content-center m-1 ">55 c</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card p-1 mb-3">
                    <div class="card-body">
                        <h5 class="card-title">Co2</h5>
                        <div class="card-img ">
                            <div class="feature-icon d-inline-flex align-items-center justify-content-start  text-bg-primary bg-gradient fs-2 mb-3">
                                <svg fill="#000000" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-sun" viewBox="0 0 512 512"  xmlns="http://www.w3.org/2000/svg"  >
<g>
	<g>
		<path d="M210.842,281.421c-1.92-2.918-4.796-4.873-8.243-5.623l-3.098-0.35c-2.202,0-4.301,0.546-6.4,1.698
			c-3.226,1.877-5.427,5.077-6.101,8.798c-2.022,9.301-5.726,16.051-10.948,20.028c-4.625,3.473-11.025,5.222-18.953,5.222
			c-10.453,0-18.5-3.499-24.602-10.65c-6.878-8.098-10.377-20.147-10.377-35.849c0-15.3,3.524-27.298,10.351-35.524
			c6.349-7.398,14.404-10.999,24.627-10.999c7.902,0,14.404,1.749,19.328,5.222c5.274,3.652,8.55,9.148,10.001,16.529
			c0.853,5.171,3.627,8.004,5.623,9.301c2.048,1.451,4.429,2.227,6.878,2.227l2.876-0.35c3.354-0.777,6.076-2.603,7.979-5.402
			c1.954-2.927,2.697-6.246,2.15-9.924c-2.304-12.228-7.723-22.178-16.222-29.602c-9.728-8.328-22.699-12.552-38.596-12.552
			c-18.022,0-32.802,6.724-43.878,19.977c-11.051,13.047-16.649,30.225-16.649,51.098c0,21.325,5.598,38.622,16.623,51.379
			c11.051,13.073,25.822,19.703,43.904,19.703c15.872,0,28.877-4.574,38.596-13.525c8.149-7.373,13.798-17.451,16.828-30.003
			C213.692,287.172,212.216,283.529,210.842,281.421z"/>
	</g>
</g>
<g>
	<g>
		<path d="M335.369,216.073c-11.341-14.899-27.469-22.451-47.915-22.451c-20.548,0-36.727,7.552-48.128,22.528
			c-9.549,12.8-14.379,29.15-14.379,48.546c0,19.396,4.821,35.703,14.404,48.427c11.375,15.027,27.554,22.647,48.102,22.647
			c20.446,0,36.574-7.629,47.898-22.596c9.796-12.723,14.771-29.022,14.771-48.478S345.173,228.873,335.369,216.073z
			 M315.477,298.197c-6.4,8.849-15.573,13.15-28.023,13.15c-12.527,0-21.7-4.301-27.998-13.099
			c-5.922-8.303-8.951-19.575-8.951-33.553c0-14.071,3.004-25.353,8.951-33.579c6.298-8.798,15.471-13.099,27.998-13.099
			c12.45,0,21.623,4.301,28.049,13.15c6.025,8.277,9.071,19.55,9.071,33.527C324.574,278.554,321.502,289.826,315.477,298.197z"/>
	</g>
</g>
<g>
	<g>
		<path d="M426.991,356.932c-2.458-2.449-5.76-3.797-9.335-3.797h-31.198c2.022-2.372,6.076-5.999,14.404-11.204l2.048-1.451
			c8.875-5.649,14.498-9.975,17.621-13.602c5.504-6.246,8.277-14.302,8.277-23.902c0-9.096-3.098-16.947-9.199-23.296
			c-13.551-14.003-39.672-13.901-52.873,0.077c-5.999,6.298-9.054,14.123-9.054,23.228v3.123c0,4.753,1.954,7.902,3.9,10.052
			c5.052,5.001,14.199,4.676,18.551,0.324c2.799-2.552,4.352-6.101,4.352-10.001v-3.499c0-3.021,1.024-4.471,1.997-5.504
			c1.024-1.101,2.722-2.372,6.699-2.372c4.053,0,5.854,1.323,6.929,2.449c0.896,0.947,1.929,2.398,1.929,5.427
			c0,3.524-0.947,6.221-2.901,8.422c-1.229,1.348-4.702,4.471-14.148,10.325c-9.6,5.777-16.853,12.297-21.598,19.422
			c-5.376,8.124-8.073,17.672-7.979,28.399l0.077,9.523h62.174c3.746,0,7.202-1.527,9.327-3.9c2.423-2.449,3.746-5.649,3.746-9.071
			C430.737,362.607,429.414,359.356,426.991,356.932z"/>
	</g>
</g>
<g>
	<g>
		<path d="M426.624,199.851C402.099,119.501,327.671,64,243.2,64c-80.853,0-152.747,50.603-180.326,126.379
			C23.424,216.653,0,259.977,0,307.2C0,384.828,63.172,448,140.8,448c15.65,0,31.403-2.773,46.822-8.303
			c44.203,13.474,91.571,10.402,133.547-8.397C340.471,442.249,362.052,448,384,448c70.579,0,128-57.421,128-128
			C512,265.353,477.978,217.899,426.624,199.851z M384,422.4c-19.396,0-38.477-5.649-55.151-16.375l-6.076-3.9l-6.502,3.174
			c-38.997,19.2-83.652,22.323-124.996,8.721l-4.378-1.451l-4.275,1.673c-13.824,5.402-27.904,8.149-41.822,8.149
			C77.278,422.4,25.6,370.722,25.6,307.2c0-39.825,20.429-76.297,54.647-97.579l3.9-2.423l1.476-4.352
			C108.501,135.1,171.827,89.6,243.2,89.6c75.247,0,141.303,50.825,160.623,123.597l1.852,6.972l6.929,2.022
			C456.747,235.128,486.4,274.423,486.4,320C486.4,376.474,440.474,422.4,384,422.4z"/>
	</g>
</g>
</svg>
                                <div class="card-text align-content-end justify-content-end m-1 ">55 c</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    

    <script>
        var url_ = window.location.href;
        alert(url_);
        url_ = url_.split('/');
        //print each element of the array
        // url_.forEach(element => {
        //     alert(element);
        // });
        
        const deviceId = url_[url_.length - 3];
        const temperatureButton = document.getElementById('temperatureButton');
        const moistureButton = document.getElementById('moistureButton');
        const co2Button = document.getElementById('co2Button');
        const lightButton = document.getElementById('lightButton');
        const humidityButton = document.getElementById('humidityButton');

        

    
        // Add event listener to the temperature button
        temperatureButton.addEventListener('click', () => {
            fetch('/api/v1/deviceData/temprature/' + deviceId)
                .then(response => response.json())
                .then(response => {
                    const temperatureValues = response.data;
                    createChart('Temperature', temperatureValues);
                });
        });
    
        // Add event listener to the moisture button
        moistureButton.addEventListener('click', () => {
            fetch('/api/v1/deviceData/moisture/' + deviceId)
                .then(response => response.json())
                .then(response => {
                    const moistureValues = response.data;
                    createChart('Moisture', moistureValues);
                });
        });

        // Add event listener to the humidity button
        humidityButton.addEventListener('click', () => {
            fetch('/api/v1/deviceData/hummidity/' + deviceId)
                .then(response => response.json())
                .then(response => {
                    const humidityValues = response.data;
                    createChart('Humidity', humidityValues);
                });
        });

        // Add event listener to the light button
        lightButton.addEventListener('click', () => {
            fetch('/api/v1/deviceData/light/' + deviceId)
                .then(response => response.json())
                .then(response => {
                    const lightValues = response.data;
                    createChart('Light', lightValues);
                });
        });

        // Add event listener to the co2 button
        co2Button.addEventListener('click', () => {
            fetch('/api/v1/deviceData/carbon/' + deviceId)
                .then(response => response.json())
                .then(response => {
                    const co2Values = response.data;
                    createChart('Co2', co2Values);
                });
        });


    
        // Function to create a chart
        let myChart = null; // Initialize chart variable

// Function to create a chart
function createChart(label, data) {
    // If a chart already exists, destroy it
    if (myChart) {
        myChart.destroy();
    }

    var ctx = document.getElementById('myChart').getContext('2d');
    myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: data,
            datasets: [{
                label: label,
                data: data,
                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                borderColor: 'rgba(255, 99, 132, 1)',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}
    </script>
</body>
</html>